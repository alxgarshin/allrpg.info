loadJsComponent("application").then((function(){if(el("form#form_myapplication")){_("a#provide_payment").on("click",(function(){const self=_("div.provide_payment_form");self.hasClass("shown")?self.hide():(_('input[name="amount[0]"]').val(parseInt(_('div[id="div_money[0]"]').text())-parseInt(_('div[id="div_money_provided[0]"]').text())),self.show(),scrollWindow(self.offset().top))}));let transactionSent=!1;_("form#form_transaction").on("submit",(function(){transactionSent||(blockDefaultSubmit=!1,transactionSent=!0,_("form#form_transaction").trigger("submit"),transactionSent=!1,blockDefaultSubmit=!0)})),_('select[name="project_payment_type_id[0]"]').on("change",(function(){const self=_(this);"paymaster"==_(`option[value="${self.val()}"]`).attr("pay_type")||"paykeeper"==_(`option[value="${self.val()}"]`).attr("pay_type")?(_('[id="field_pay_by_card[0]"]').show(),_('[id="field_test_payment[0]"]').show()):(_('[id="field_pay_by_card[0]"]').hide(),_('[id="field_test_payment[0]"]').hide())})),_('select[name="project_payment_type_id[0]"]').change(),_('input[name="project_character_id[0]"]').on("change",(function(){const self=_(this);actionRequest({action:"myapplication/get_list_of_groups",obj_id:self.val()})})),_('input[name="project_character_id[0]"]:checked').change();let commentsChecked=!1;_('div.conversation_form_data textarea[name="content"]').on("change",(function(){_(this).val()&&(blockDefaultSubmit=!0,commentsChecked=!1)})),_("div.conversation_form_data button.main").on("click",(function(){const self=_(this);blockDefaultSubmit=!1,commentsChecked=!0,self.closest("form").trigger("submit")})),_("form#form_myapplication").on("submit",(function(){!commentsChecked&&blockDefaultSubmit&&(_('div.conversation_form_data textarea[name="content"]')?.val()&&_('input[id="go_back_after_save[0]"]').is(":checked")?fraymNotyPrompt(null,LOCALE.leavingApplicationWithComment,(function(dialog){blockDefaultSubmit=!1,commentsChecked=!0,_("form#form_myapplication").trigger("submit"),dialog.close()}),(function(dialog){scrollWindow(_('div.conversation_form_data textarea[name="content"]').offset().top),dialog.close()})):(blockDefaultSubmit=!1,commentsChecked=!0,_("form#form_myapplication").trigger("submit")))})),el('form#form_myapplication input[type="checkbox"][name^="project_fee_ids[0]"]')?(_('form#form_myapplication input[type="checkbox"][name^="project_fee_ids[0]"]').on("change",(function(){const self=_('div[id="div_money_paid[0]"]');let money=0;_('form#form_myapplication input[type="checkbox"][name^="project_fee_ids[0]"]').each((function(){const self=_(this);if(self.is(":checked")){const name=self.attr("name"),label=_(`label[for="${name}"]`).text();label.match(/-\d+$/)?money-=parseInt(label.match(/\d+$/)):money+=parseInt(label.match(/\d+$/))}})),_('div[id="div_money[0]"]').text(money),parseInt(_('div[id="div_money_provided[0]"]').text())>=parseInt(_('div[id="div_money[0]"]').text())&&parseInt(_('div[id="div_money[0]"]').text())>0?self.html('<span class="sbi sbi-check"></span>'):self.html('<span class="sbi sbi-times"></span>'),loadSbiBackground(),window.feeLockedRoomCheck()})),_('form#form_myapplication input[type="checkbox"][name^="project_fee_ids[0]"]').change()):window.feeLockedRoomCheck(),_("a#add_neighboor_myapplication").on("click",(function(){createPseudoPrompt(`<div><input type="text" name="application_name" placehold="${LOCALE.enterName}" obj_id="${_(this).attr("obj_id")}"><input type="hidden" name="application_id"></div>`,LOCALE.searchCapitalizedApplications,[{text:LOCALE.inviteCapitalized,class:"main",click:function(){const self=getNotyDialogDOM(),input=self.find("input[type=text]"),input2=self.find("input[type=hidden]");input2.val()>0?actionRequest({action:"myapplication/add_neighboor_request",application_id:input.attr("obj_id"),user_id:input2.val(),room_id:_('select[name^="rooms_selector"]').val()}):showMessage({text:LOCALE.wrongUser,type:"error",timeout:5e3})}}],null,(function(){const self=getNotyDialogDOM(),input=self.find("input[type=text]"),input2=self.find("input[type=hidden]");fraymPlaceholder(input),fraymAutocompleteApply(input,{source:`/helper_application/?nochar=1&obj_id=${input.attr("obj_id")}`,makeEmptySearches:!0,select:function(){const self=getNotyDialogDOM();input2.val(this.obj_id),self.find("button.main").click()},change:function(value){this.options.minLength=isInt(value)?1:3,value||input2.val(null)}}),input.trigger("activate")}))}))}withDocumentEvents&&_arSuccess("add_neighboor_request",(function(jsonData,params,target){showMessageFromJsonData(jsonData),notyDialog?.close()}))}));